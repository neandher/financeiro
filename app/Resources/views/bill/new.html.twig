{% extends 'base.html.twig' %}

{% block body %}

    <!-- BEGIN PAGE TITLE-->
    <h3 class="page-title"> Gerencimento de Contas
        <small></small>
    </h3>
    <!-- END PAGE TITLE-->

    <div class="portlet light bordered">

        <div class="portlet-title">

            <div class="caption">
                <i class="icon-plus font-green-sharp"></i>
                <span class="caption-subject font-green-sharp bold uppercase">{{ 'bill.title.new'|trans }}</span>
            </div>

            <div class="actions">
                <a href="{{ path('bill_index') ~ pagination_helper.buildQuery }}" class="btn default">
                    <span class="glyphicon glyphicon-circle-arrow-left"></span> {{ 'form.link.go_back'|trans }}
                </a>
            </div>

            {#<div class="pull-right" style="padding-top: 20px;">
                <a href="{{ path('bill_index') ~ pagination_helper.buildQuery }}" class="btn default">
                    <span class="glyphicon glyphicon-circle-arrow-left"></span> {{ 'form.link.go_back'|trans }}
                </a>
            </div>#}

        </div>

        <div class="portlet-body form">

            {{ form_start(form, {'action': path('bill_new') ~ pagination_helper.buildQuery, 'attr' : {'class' : 'horizontal-form', 'novalidate': 'novalidate'}}) }}

            {{ form_errors(form) }}

            {{ include('partials/alerts.html.twig') }}

            <div class="form-body">

                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active">
                        <a href="#dados" aria-controls="dados" role="tab" data-toggle="tab">Dados</a>
                    </li>
                    <li role="presentation">
                        <a href="#parcelas" aria-controls="parcelas" role="tab" data-toggle="tab">Parcelas</a>
                    </li>
                </ul>

                <br>

                <div class="tab-content">

                    <div role="tabpanel" class="tab-pane active" id="dados">
                        <div class="row">
                            {{ form_row(form.billCategory, {'attr': {'autofocus': true}}) }}
                            {{ form_row(form.description) }}
                            {{ form_row(form.billPlan) }}
                            {{ form_row(form.choices.bank) }}
                            {{ form_row(form.note) }}
                        </div>
                    </div>

                    <div role="tabpanel" class="tab-pane" id="parcelas">

                        <div id="installments" class="panel panel-default"
                             data-prototype="{{ form_widget(form.billInstallments.vars.prototype)|e('html_attr') }}">
                            {% if form.vars.submitted and form.vars.valid == false %}
                                {% for billInstallment in form.billInstallments %}
                                    <div class="panel-body">
                                        {{ form_widget(billInstallment) }}
                                    </div>
                                {% endfor %}
                            {% endif %}
                        </div>

                    </div>

                </div>

            </div>

            <div class="form-actions">
                {{ form_widget(form.buttons.save_and_keep, {'attr' : {'class' : 'green'}}) }}
                {{ form_widget(form.buttons.save_and_new, {'attr' : {'class' : 'green'}}) }}
                {{ form_widget(form.buttons.save_and_close, {'attr' : {'class' : 'green'}}) }}
            </div>



            {{ form_end(form) }}

        </div>

    </div>

{% endblock %}

{% block javascripts %}

    <script>
        jQuery(document).ready(function () {
            installmentsInit();
        });
    </script>

{% endblock %}